{% extends "base.html" %}

{% block title %}{{ title }} - Escola Sol Maior{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <div class="d-flex justify-content-between align-items-center mt-4 mb-4">
            <h1><i class="fas fa-door-open me-2"></i>{{ title }}</h1>
            <a href="{{ url_for('admin.rooms') }}" class="btn btn-secondary">
                <i class="fas fa-arrow-left me-2"></i>Voltar
            </a>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-lg-8 mx-auto">
        <div class="card">
            <div class="card-header">
                <h5><i class="fas fa-door-open me-2"></i>Dados da Sala</h5>
            </div>
            <div class="card-body">
                <form method="POST">
                    {{ form.hidden_tag() }}
                    
                    <div class="row">
                        <div class="col-md-8 mb-3">
                            {{ form.name.label(class="form-label") }}
                            {{ form.name(class="form-control" + (" is-invalid" if form.name.errors else ""), placeholder="Ex: Sala de Piano 1") }}
                            {% if form.name.errors %}
                                <div class="invalid-feedback">
                                    {% for error in form.name.errors %}{{ error }}{% endfor %}
                                </div>
                            {% endif %}
                        </div>
                        
                        <div class="col-md-4 mb-3">
                            {{ form.capacity.label(class="form-label") }}
                            <div class="input-group">
                                {{ form.capacity(class="form-control" + (" is-invalid" if form.capacity.errors else "")) }}
                                <span class="input-group-text">
                                    <i class="fas fa-users"></i>
                                </span>
                                {% if form.capacity.errors %}
                                    <div class="invalid-feedback">
                                        {% for error in form.capacity.errors %}{{ error }}{% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                            <div class="form-text">Número máximo de pessoas</div>
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        {{ form.location.label(class="form-label") }}
                        {{ form.location(class="form-control", placeholder="Ex: 2º andar, corredor direito") }}
                        <div class="form-text">
                            <i class="fas fa-map-marker-alt me-1"></i>
                            Localização dentro da escola
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        {{ form.equipment.label(class="form-label") }}
                        {{ form.equipment(class="form-control", rows="4", placeholder="Ex: Piano acústico Yamaha, estante de partitura, banqueta regulável, sistema de som, microfone...") }}
                        <div class="form-text">
                            <i class="fas fa-tools me-1"></i>
                            Liste todos os equipamentos e instrumentos disponíveis na sala
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <div class="form-check form-switch">
                            {{ form.is_available(class="form-check-input") }}
                            {{ form.is_available.label(class="form-check-label") }}
                        </div>
                        <div class="form-text text-muted">
                            Desmarque se a sala estiver temporariamente indisponível (manutenção, reforma, etc.)
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        {{ form.notes.label(class="form-label") }}
                        {{ form.notes(class="form-control", rows="3", placeholder="Observações especiais, restrições de uso, cuidados especiais...") }}
                    </div>
                    
                    <!-- Preview da Sala -->
                    <div class="card bg-light mb-4">
                        <div class="card-body">
                            <h6 class="card-title">
                                <i class="fas fa-eye me-2"></i>Preview da Sala
                            </h6>
                            <div class="row">
                                <div class="col-md-6">
                                    <p class="mb-1">
                                        <strong>Nome:</strong> 
                                        <span id="preview-name" class="text-muted">Digite o nome da sala</span>
                                    </p>
                                    <p class="mb-1">
                                        <strong>Capacidade:</strong> 
                                        <span id="preview-capacity" class="text-muted">Digite a capacidade</span>
                                    </p>
                                    <p class="mb-0">
                                        <strong>Localização:</strong> 
                                        <span id="preview-location" class="text-muted">Digite a localização</span>
                                    </p>
                                </div>
                                <div class="col-md-6">
                                    <p class="mb-1">
                                        <strong>Status:</strong> 
                                        <span id="preview-status" class="badge bg-success">Disponível</span>
                                    </p>
                                    <p class="mb-0">
                                        <strong>Equipamentos:</strong> 
                                        <span id="preview-equipment" class="text-muted">Liste os equipamentos</span>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="d-flex justify-content-between">
                        <a href="{{ url_for('admin.rooms') }}" class="btn btn-secondary">
                            <i class="fas fa-times me-2"></i>Cancelar
                        </a>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save me-2"></i>Salvar Sala
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
// Preview em tempo real
document.addEventListener('DOMContentLoaded', function() {
    const nameInput = document.getElementById('name');
    const capacityInput = document.getElementById('capacity');
    const locationInput = document.getElementById('location');
    const equipmentInput = document.getElementById('equipment');
    const availableInput = document.getElementById('is_available');
    
    const previewName = document.getElementById('preview-name');
    const previewCapacity = document.getElementById('preview-capacity');
    const previewLocation = document.getElementById('preview-location');
    const previewEquipment = document.getElementById('preview-equipment');
    const previewStatus = document.getElementById('preview-status');
    
    function updatePreview() {
        previewName.textContent = nameInput.value || 'Digite o nome da sala';
        previewCapacity.textContent = capacityInput.value ? capacityInput.value + ' pessoas' : 'Digite a capacidade';
        previewLocation.textContent = locationInput.value || 'Digite a localização';
        previewEquipment.textContent = equipmentInput.value || 'Liste os equipamentos';
        
        if (availableInput.checked) {
            previewStatus.className = 'badge bg-success';
            previewStatus.textContent = 'Disponível';
        } else {
            previewStatus.className = 'badge bg-warning';
            previewStatus.textContent = 'Indisponível';
        }
    }
    
    nameInput.addEventListener('input', updatePreview);
    capacityInput.addEventListener('input', updatePreview);
    locationInput.addEventListener('input', updatePreview);
    equipmentInput.addEventListener('input', updatePreview);
    availableInput.addEventListener('change', updatePreview);
    
    // Initialize preview
    updatePreview();
});
</script>
{% endblock %}
